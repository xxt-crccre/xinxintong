<div ng-controller='shelfCtrl'>
	<div ng-show='filterOpened'>
		<div id='filter'>
			<div class='form-group' ng-hide='catelogs.length<=1'>
				<select class='form-control' ng-model='selectedCatelog' ng-options='c.name for c in catelogs' ng-change='listProduct()'></select>
			</div>
			<div class='form-group' ng-repeat='p in selectedCatelog.properties'>
				<div class='name' ng-bind='p.name'></div>
				<div class='options'>
					<span class='option' ng-class="{'selected':v._selected}" ng-repeat="v in selectedCatelog.propValues[p.id]" ng-bind='v.name' ng-click='clickOption(p,v)'></span>
				</div>
			</div>
			<div class='date input-group' tms-datetime tms-datetime-value="options.time.begin" tms-datetime-items="yMd" tms-datetime-auto-now="N" ng-if="selectedCatelog.has_validity='Y'">
                <span class='input-group-btn'>
                    <button class='btn btn-default' ng-click='prevDay()'>上一天</button>
                </span>
                <p class='form-control' ng-bind="options.time.begin|date:'yy/MM/dd'"></p>
                <span class='input-group-btn'>
                    <button class='btn btn-default' ng-click='nextDay()'>下一天</button>
                </span>
            </div>
			<footer>
				<button ng-click='toggleFilter()'>取消</button>
				<button ng-click='doFilter()'>确定</button>
			</footer>
		</div>
	</div>
	<div ng-show='!filterOpened'>
		<div id='filterSummary' class='form-control input-lg'>筛选条件：<span ng-bind="filterSummary"></span></div>
		<div id='products' class='row'>
			<div class='col-sm-6' ng-repeat='prod in products'>
				<div class='thumbnail' ng-click='gotoProduct(prod)'>
					<div class='profile'>
						<div class='product-img'><img ng-src='{{prod.main_img}}'></div>
						<div class='product properties'>
							<div class='product-name' ng-bind='prod.name'></div>
							<div class='property-ext'><span ng-repeat='ep in prod.propValue'>{{ep.name}}</span></div>
						</div>
					</div>
					<div class='product-detail_text' ng-bind='prod.detail_text'></div>
					<div class='cateSkus' ng-repeat='cateSku in prod.cateSkus'>
						<div class='skus'>
							<span class='sku' ng-repeat='sku in cateSku.skus' ng-class="{'unavailable':!sku._available}"><em ng-bind='sku._summary'></em></span>
						</div>
					</div>
					<div class='empty-sku' ng-if='prod.cateSkus!==false&&prod._countOfSkus===0'>
						<span>没有库存</span>
					</div>
					<div class='empty-sku' ng-if='prod.cateSkus===false'>
						<span>空闲</span>
					</div>
				</div>
			</div>
		</div>
		<footer>
			<button ng-click='gotoOrderlist()'>我的订单</button>
			<button class='cart' ng-click='gotoCart()'><span>已选</span><div class='status' ng-bind='Cart.countOfProducts'></div></button>
			<button ng-click='toggleFilter()'>筛选</button>
		</footer>
	</div>
</div>